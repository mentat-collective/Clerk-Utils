<!DOCTYPE html>
<html><head><title>show-cljs and CLJC Notebooks</title><meta charset="UTF-8"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="This notebook documents the show-cljs macro. Use this macro if you wantcompile ClojureScript code for use in Clerk&apos;s browser page." property="og:description"><meta content="show-cljs and CLJC Notebooks" property="og:title"><meta content="article:clerk" property="og:type"><meta content="summary_large_image" name="twitter:card"><script src="https://cdn.tailwindcss.com?plugins=typography" type="text/javascript"></script><script>tailwind.config = {
  darkMode: "class",
  content: ["./tw/viewer.js", "./tw/**/*.edn"],
  safelist: ['dark'],
  theme: {
    extend: {},
    fontFamily: {
      sans: ["Fira Sans", "-apple-system", "BlinkMacSystemFont", "sans-serif"],
      serif: ["PT Serif", "serif"],
      mono: ["Fira Mono", "monospace"]
    }
  },
  variants: {
    extend: {},
  },
  plugins: [],
}
</script><style type="text/tailwindcss">@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  html {
    font-size: 18px;
  }
  @media (max-width: 600px) {
    html {
      font-size: 16px;
    }
  }
  .font-condensed { font-family: "Fira Sans Condensed", sans-serif; }
  .font-inter     { font-family: "Inter", sans-serif; }
  body {
    @apply font-serif antialiased text-gray-900 sm:overscroll-y-none;
  }
  code, .code {
    @apply font-mono text-sm text-gray-900 bg-slate-50 px-0.5 py-px rounded dark:bg-gray-800;
  }
  code::before, code::after { @apply content-none !important; }
  h1, h3, h4, h5, h6 {
    @apply font-condensed font-bold mt-8 first:mt-0;
  }
  h2 {
    /*We cannot collapse margins due to nesting but we want to*/
    /*keep the h2’s large margin visible*/
    @apply font-condensed font-bold mt-8 first:mt-2;
  }
  h1 { @apply text-4xl; }
  h2 { @apply text-3xl; }
  h3 { @apply text-2xl; }

  button { @apply focus:outline-none; }
  strong { @apply font-bold; }
  em     { @apply italic; }
  pre    { @apply m-0 font-mono; }
}

/* Compatibility */
/* --------------------------------------------------------------- */
/* TODO: Verify which colors are in use and replace with Tailwind
   colors accordingly. Move Nj-specific styles out of here. */

:root {
  --teal-color: #31afd0;
  --dark-teal-color: #095960;
  --near-black-color: #2e2e2c;
  --red-color: #d64242;
  --dark-blue-color: #1f2937;
  --dark-blue-60-color: rgba(28, 42, 56, 0.6);
  --gray-panel-color: rgba(239, 241, 245, 1.000);
  --brand-color: var(--dark-blue-color);
  --link-color: #5046e4;
  --command-bar-selected-color: var(--teal-color);
}

.serif      { @apply font-serif; }
.sans-serif { @apply font-sans; }
.monospace  { @apply font-mono; }
.inter      { @apply font-inter; }

.border-color-teal { border-color: var(--dark-teal-color); }
.teal { color: var(--teal-color); }
.bg-dark-blue { background: var(--dark-blue-color); }
.bg-dark-blue-60 { background: rgba(28, 42, 56, 0.6); }
.bg-gray-panel { background: var(--gray-panel-color); }
.text-dark-blue  { color: var(--dark-blue-color); }
.text-dark-blue-60 { color: var(--dark-blue-60-color); }
.border-dark-blue-30 { border-color: rgba(28, 42, 56, 0.6); }
.text-brand { color: var(--dark-blue-color); }
.bg-brand { background: var(--dark-blue-color); }
.text-selected { color: white; }
.red { color: var(--red-color); }

/* Disclose Button */
/* --------------------------------------------------------------- */

.disclose {
  @apply content-none border-solid cursor-pointer inline-block relative mr-[3px] top-[-2px] transition-all;
  border-color: var(--near-black-color) transparent;
  border-width: 6px 4px 0;
}
.disclose:hover {
  border-color: var(--near-black-color) transparent;
}
.dark .disclose,
.dark .disclose:hover {
  border-color: white transparent;
}
.disclose.collapsed {
  @apply rotate-[-90deg];
}

/* Layout */
/* --------------------------------------------------------------- */

.page {
  @apply max-w-5xl mx-auto px-12 box-border flex-shrink-0;
}
.max-w-prose { @apply max-w-[46rem] !important; }
.max-w-wide  { @apply max-w-3xl !important; }

/* List Styles */
/* --------------------------------------------------------------- */

.task-list-item + .task-list-item,
.viewer-markdown ul ul {
  @apply mt-1 mb-0;
}

/* compact TOC */
.viewer-markdown .toc ul {
  list-style: none;
  @apply my-1;
}

/* Code Viewer */
/* --------------------------------------------------------------- */

.viewer-code {
  @apply font-mono bg-slate-100 rounded-sm text-sm overflow-x-auto dark:bg-gray-800;
}
.viewer-code .cm-content {
  @apply py-4 px-8;
}
@media (min-width: 960px){
  .viewer-notebook .viewer-code .cm-content {
    @apply py-4 pl-12;
  }
}
/* Don’t show focus outline when double-clicking cell in Safari */
.cm-scroller { @apply focus:outline-none; }

/* Syntax Highlighting */
/* --------------------------------------------------------------- */

.inspected-value { @apply text-xs font-mono leading-[1.25rem]; }
.cmt-strong, .cmt-heading { @apply font-bold; }
.cmt-italic, .cmt-emphasis { @apply italic; }
.cmt-strikethrough { @apply line-through; }
.cmt-link { @apply underline; }
.untyped-value { @apply whitespace-nowrap; }

.cm-editor, .cmt-default, .viewer-result {
  @apply text-slate-800 dark:text-slate-300;
}
.cmt-keyword {
  @apply text-purple-800 dark:text-pink-400;
}
.cmt-atom, .cmt-bool, .cmt-url, .cmt-contentSeparator, .cmt-labelName {
  @apply text-blue-900 dark:text-blue-300;
}
.cmt-inserted, .cmt-literal {
  @apply text-emerald-700 dark:text-emerald-200;
}
.cmt-string, .cmt-deleted {
  @apply text-rose-700 dark:text-sky-300;
}
.cmt-italic.cmt-string {
  @apply dark:text-sky-200;
}
.cmt-regexp, .cmt-escape {
  @apply text-orange-500 dark:text-orange-300;
}
.cmt-variableName {
  @apply text-blue-800 dark:text-sky-300;
}
.cmt-typeName, .cmt-namespace {
  @apply text-emerald-600 dark:text-emerald-300;
}
.cmt-className {
  @apply text-teal-600 dark:text-teal-200;
}
.cmt-macroName {
  @apply text-teal-700 dark:text-teal-200;
}
.cmt-propertyName {
  @apply text-blue-700 dark:text-blue-200;
}
.cmt-comment {
  @apply text-slate-500 dark:text-slate-400;
}
.cmt-meta {
  @apply text-slate-600 dark:text-slate-400;
}
.cmt-invalid {
  @apply text-red-500 dark:text-red-300;
}

.result-data {
  @apply font-mono text-sm overflow-x-auto whitespace-nowrap leading-normal;
}
.result-data::-webkit-scrollbar, .path-nav::-webkit-scrollbar {
  @apply h-0;
}
.result-data-collapsed {
  @apply whitespace-nowrap;
}
.result-data-field {
  @apply ml-4 whitespace-nowrap;
}
.result-data-field-link{
  @apply ml-4 whitespace-nowrap cursor-pointer;
}
.result-data-field-link:hover {
  @apply text-black bg-black/5;
}
.result-text-empty {
  color: rgba(0,0,0,.3);
}
.browsify-button:hover {
  box-shadow: -2px 0 0 2px #edf2f7;
}

/* Prose */
/* --------------------------------------------------------------- */

.viewer-notebook,
.viewer-markdown {
  @apply prose
    dark:prose-invert
    prose-a:text-blue-600 prose-a:no-underline hover:prose-a:underline
    dark:prose-a:text-blue-300
    prose-p:mt-4 prose-p:leading-snug
    prose-ol:mt-4 prose-ol:mb-6 prose-ol:leading-snug
    prose-ul:mt-4 prose-ul:mb-6 prose-ul:leading-snug
    prose-blockquote:mt-4 prose-blockquote:leading-snug
    prose-hr:mt-6 prose-hr:border-t-2 prose-hr:border-solid prose-hr:border-slate-200
    prose-figure:mt-4
    prose-figcaption:mt-2 prose-figcaption:text-xs
    prose-headings:mb-4
    prose-table:mt-0
    prose-th:mb-0
    prose-img:my-0
    prose-code:font-medium prose-code:bg-slate-100
    max-w-none;
}
.viewer-markdown blockquote p:first-of-type:before,
.viewer-markdown blockquote p:last-of-type:after {
  @apply content-none;
}

/* Images */
/* --------------------------------------------------------------- */


/* Todo Lists */
/* --------------------------------------------------------------- */

.contains-task-list {
  @apply pl-6 list-none;
}
.contains-task-list input[type="checkbox"] {
  @apply appearance-none h-4 w-4 rounded border border-slate-200 relative mr-[0.3rem] ml-[-1.5rem] top-[0.15rem];
}
.contains-task-list input[type="checkbox"]:checked {
  @apply border-indigo-600 bg-indigo-600 bg-no-repeat bg-contain;
  background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
}

/* Markdown TOC */
/* --------------------------------------------------------------- */

.viewer-markdown .toc      { @apply mt-4; }
.viewer-markdown h1 + .toc { @apply mt-8; }

.viewer-markdown .toc h1,
.viewer-markdown .toc h2,
.viewer-markdown .toc h3,
.viewer-markdown .toc h4,
.viewer-markdown .toc h5,
.viewer-markdown .toc h6 {
  @apply text-base text-indigo-600 font-sans my-0;
}
.viewer-markdown .toc a {
  @apply text-indigo-600 font-normal no-underline hover:underline;
}
.viewer-markdown .toc li    { @apply m-0; }
.viewer-markdown .toc ul ul { @apply pl-4; }

/* Notebook Spacing */
/* --------------------------------------------------------------- */

.viewer-notebook { @apply py-16; }
#clerk-static-app .viewer-notebook { @apply pt-[0.8rem] pb-16; }
.viewer-markdown *:first-child:not(.viewer-code):not(li):not(h2) { @apply mt-0; }
/*.viewer + .viewer { @apply mt-6; }*/
.viewer + .viewer-result { @apply mt-0; }
.viewer-code + .viewer-result { @apply mt-3; }
.viewer-markdown + .viewer-markdown { @apply mt-0; }

/* Sidenotes */
/* --------------------------------------------------------------- */

.sidenote-ref {
  @apply top-[-3px] inline-flex justify-center items-center w-[18px] h-[18px]
    rounded-full bg-slate-100 border border-slate-300 hover:bg-slate-200 hover:border-slate-300
    m-0 ml-[4px] cursor-pointer;
}
.sidenote {
  @apply hidden float-left clear-both mx-[2.5%] my-4 text-xs relative w-[95%];
}
.sidenote-ref.expanded + .sidenote {
  @apply block;
}
@media (min-width: 860px) {
  .sidenote-ref {
    @apply top-[-0.5em] w-auto h-auto inline border-0 bg-transparent m-0 pointer-events-none;
  }
  .sidenote sup { @apply inline; }
  .viewer-markdown .contains-sidenotes p { @apply max-w-[65%]; }
  .viewer-markdown p .sidenote {
    @apply mr-[-54%] mt-[0.2rem] w-1/2 float-right clear-right relative block;
  }
}
.viewer-code + .viewer:not(.viewer-markdown):not(.viewer-code):not(.viewer-code-folded),
.viewer-code-folded + .viewer:not(.viewer-markdown):not(.viewer-code):not(.viewer-code-folded),
.viewer-result + .viewer-result {
  @apply mt-2;
}
.viewer-code + .viewer-code-folded {
  @apply mt-4;
}
.viewer-result {
  @apply leading-tight mb-6;
}
.viewer-result figure {
  @apply mt-0 !important;
}
@media (min-width: 768px) {
  .devcard-desc > div {
    @apply max-w-full m-0;
  }
}

/* Command Palette */
/* --------------------------------------------------------------- */

.nj-commands-input {
  @apply bg-transparent text-white;
}
.nj-context-menu-item:hover:not([disabled]) {
  @apply cursor-pointer;
  background-color: rgba(255,255,255,.14);
}

/* Devdocs */
/* --------------------------------------------------------------- */

.logo, .logo-white {
  @apply block indent-[-999em];
  background: url(/images/nextjournal-logo.svg) center center no-repeat;
}
.devdocs-body {
  @apply font-inter;
}

/* Workarounds */
/* --------------------------------------------------------------- */

/* Fixes vega viewer resizing into infinity */
.vega-embed .chart-wrapper { @apply h-auto !important; }
/* fixes fraction separators being overridden by tw’s border-color */
.katex * { @apply border-black; }
</style><script src="/js/_data/8Vu7sBmZoJDRPJJyQfKL1ufTz3faQLkyRj9oHVVb8f7LBgCtVN7YYbTSbJWTKJ374W2xs75vFRHpEhLrpFdfTxAmWU.js" type="module"></script><link href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" rel="stylesheet" type="text/css"><link href="https://fonts.bunny.net" rel="preconnect"><link href="https://fonts.bunny.net/css?family=fira-code:400,700%7Cfira-mono:400,700%7Cfira-sans:400,400i,500,500i,700,700i%7Cfira-sans-condensed:700,700i%7Cpt-serif:400,400i,700,700i" rel="stylesheet" type="text/css"></head><body><div id="clerk-static-app"></div><script type="module">let viewer = nextjournal.clerk.sci_env
let app = nextjournal.clerk.static_app
let opts = viewer.read_string("{:out-path \"public\", :path->doc {\"dev/clerk_utils/show.cljc\" {:path [], :nextjournal/value {:toc {:type :toc, :children [{:type :toc, :content [{:type :text, :text \"show-cljs and CLJC Notebooks\"}], :heading-level 1, :attrs {:id \"show-cljs-and-cljc-notebooks\"}, :path [:content 0], :children [{:type :toc, :content [{:type :text, :text \"Project Requirements\"}], :heading-level 2, :attrs {:id \"project-requirements\"}, :path [:content 8]} {:type :toc, :content [{:type :monospace, :content [{:type :text, :text \"show-cljs\"}]} {:type :text, :text \" basics\"}], :heading-level 2, :attrs {:id \"show-cljs-basics\"}, :path [:content 10]} {:type :toc, :content [{:type :text, :text \"Automatic Reloading\"}], :heading-level 2, :attrs {:id \"automatic-reloading\"}, :path [:content 14]} {:type :toc, :content [{:type :text, :text \"Exporting code from ClojureScript\"}], :heading-level 2, :attrs {:id \"exporting-code-from-clojurescript\"}, :path [:content 16]} {:type :toc, :content [{:type :text, :text \"Project Setup\"}], :heading-level 2, :attrs {:id \"project-setup\"}, :path [:content 24], :children [{:type :toc, :content [{:type :text, :text \"deps.edn\"}], :heading-level 3, :attrs {:id \"deps.edn\"}, :path [:content 28]} {:type :toc, :content [{:type :text, :text \"shadow-cljs\"}], :heading-level 3, :attrs {:id \"shadow-cljs\"}, :path [:content 32]} {:type :toc, :content [{:type :text, :text \"package.json\"}], :heading-level 3, :attrs {:id \"package.json\"}, :path [:content 40]} {:type :toc, :content [{:type :text, :text \"user.clj\"}], :heading-level 3, :attrs {:id \"user.clj\"}, :path [:content 48]} {:type :toc, :content [{:type :text, :text \"bb.edn\"}], :heading-level 3, :attrs {:id \"bb.edn\"}, :path [:content 52]} {:type :toc, :content [{:type :text, :text \"Clerk's Garden\"}], :heading-level 3, :attrs {:id \"clerk's-garden\"}, :path [:content 60]}]} {:type :toc, :content [{:type :text, :text \"Thanks and Support\"}], :heading-level 2, :attrs {:id \"thanks-and-support\"}, :path [:content 63]} {:type :toc, :content [{:type :text, :text \"License\"}], :heading-level 2, :attrs {:id \"license\"}, :path [:content 67]}]}]}, :toc-visibility true, :atom-var-name->state #viewer-eval (nextjournal.clerk.render/intern-atoms! {}), :auto-expand-results? nil, :scope {:namespace :clerk-utils.show}, :bundle? false, :open-graph {:type \"article:clerk\", :title \"show-cljs and CLJC Notebooks\", :description \"This notebook documents the show-cljs macro. Use this macro if you wantcompile ClojureScript code for use in Clerk's browser page.\"}, :title \"show-cljs and CLJC Notebooks\", :blocks [{:nextjournal/value [:div.viewer-markdown [\"h1\" {:id \"show-cljs-and-cljc-notebooks\"} [:span \"show-cljs and CLJC Notebooks\"]] [:p [:span \"This notebook documents the \"] [:code [:span \"show-cljs\"]] [:span \" macro. Use this macro if you want\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"compile ClojureScript code for use in Clerk's browser page.\"]] [:p [:span \"Some reasons you might do this:\"]] [:ul [:li [:<> [:span \"You need more performance than the\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"standard \"] [:a {:href \"https://github.com/babashka/sci\"} [:span \"SCI\"]] [:span \" environment can offer\"]]] [:li [:<> [:span \"Your code uses macros that aren't supported via SCI\"]]] [:li [:<> [:span \"You want the code that you're writing and documenting to be available to\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"other ClojureScript consumers as a library\"]]]] [:p [:code [:span \"show-cljs\"]] [:span \" allows you to write ClojureScript code that passes directly\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"through the ClojureScript compiler, but still renders and runs in Clerk:\"]]], :nextjournal/viewer {:name :html-, :render-fn #viewer-fn identity, :hash \"5dsKyVZX2dPvsyoeg6dNrfeuqAh5UK\"}} {:nextjournal/value \"(show-cljs\\n [:pre\\n  (str \\\"I was compiled by ClojureScript version \\\"\\n       *clojurescript-version*\\n       \\\".\\\")])\", :nextjournal/opts {:loc {:line 24, :column 1}}, :nextjournal/viewer {:name :code, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5duGVW4Xoi1QoW73J5wMRghqm9uVoW\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"clerk-utils.show-1424936374\", :nextjournal/viewer {:render-fn #viewer-fn (fn render-var [fn-name] (applied-science.js-interop/update-in! js/window [:show-cljs fn-name] (fn [x] (or x (reagent.core/atom {:loading? true})))) (let [res (clojure.core/deref (j/get-in js/window [:show-cljs fn-name]))] (if (:loading? res) [:div.show-cljs-loading {:style {:color \"rgba(0,0,0,0.5)\"}} \"Loading...\"] (let [result (try ((:f res)) (catch js/Error e (js/console.error e) [nextjournal.clerk.render/error-view e]))] (if (and (vector? result) (not (:inspect (meta result)))) [:div.show-cljs-loaded result] [nextjournal.clerk.render/inspect result]))))), :hash \"5dsETUDCusAwKc7zXe7p2bq3JGeWBz\"}}}, :nextjournal/viewer {:name :clerk/result, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5drtBjvRGKwhUFrDTtWvTAduWDETV1\"}} {:nextjournal/value [:div.viewer-markdown [:p [:code [:span \"show-cljs\"]] [:span \" lives in \"] [:code [:span \"mentat.clerk-utils.show\"]] [:span \":\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:div.viewer-code [#viewer-eval nextjournal.clerk.render/inspect-presented {:path (0), :nextjournal/value \"(ns my-app\\n  (:require [mentat.clerk-utils.show :refer [show-cljs show-sci]]\\n            [nextjournal.clerk :as-alias clerk]))\\n\", :nextjournal/viewer {:name :code, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5duGVW4Xoi1QoW73J5wMRghqm9uVoW\"}}]], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:blockquote [:p [:span \"This macro originally comes from Matt\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"Huebert's \"] [:a {:href \"https://github.com/mhuebert/clerk-cljs\"} [:span \"clerk-cljs\"]] [:span \" library, and\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"is used throughout \"] [:a {:href \"https://inside-out.matt.is/\"} [:span \"https://inside-out.matt.is/\"]] [:span \".\"]]] [\"h2\" {:id \"project-requirements\"} [:span \"Project Requirements\"]] [:p [:span \"Running Clerk interactively with cljc files a custom ClojureScript build\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"requires some additional project configuration. This is fairly involved!\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"Follow the \"] [:a {:href \"#project-setup\"} [:span \"instructions below\"]] [:span \", and then create your first\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:code [:span \"cljc\"]] [:span \" file and require \"] [:code [:span \"mentat.clerk-utils.show\"]] [:span \" as above.\"]] [\"h2\" {:id \"show-cljs-basics\"} [:code [:span \"show-cljs\"]] [:span \" basics\"]] [:p [:span \"As with \"] [:code [:span \"show-sci\"]] [:span \", Vectors are interpreted as Reagent components:\"]]], :nextjournal/viewer {:name :html-, :render-fn #viewer-fn identity, :hash \"5dsKyVZX2dPvsyoeg6dNrfeuqAh5UK\"}} {:nextjournal/value \"(show-cljs\\n (let [text (str \\\"Hi from ClojureScript version \\\"\\n                 *clojurescript-version*\\n                 \\\"!\\\")]\\n   [:pre text]))\", :nextjournal/opts {:loc {:line 54, :column 1}}, :nextjournal/viewer {:name :code, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5duGVW4Xoi1QoW73J5wMRghqm9uVoW\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"clerk-utils.show-674505266\", :nextjournal/viewer {:render-fn #viewer-fn (fn render-var [fn-name] (applied-science.js-interop/update-in! js/window [:show-cljs fn-name] (fn [x] (or x (reagent.core/atom {:loading? true})))) (let [res (clojure.core/deref (j/get-in js/window [:show-cljs fn-name]))] (if (:loading? res) [:div.show-cljs-loading {:style {:color \"rgba(0,0,0,0.5)\"}} \"Loading...\"] (let [result (try ((:f res)) (catch js/Error e (js/console.error e) [nextjournal.clerk.render/error-view e]))] (if (and (vector? result) (not (:inspect (meta result)))) [:div.show-cljs-loaded result] [nextjournal.clerk.render/inspect result]))))), :hash \"5dsETUDCusAwKc7zXe7p2bq3JGeWBz\"}}}, :nextjournal/viewer {:name :clerk/result, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5drtBjvRGKwhUFrDTtWvTAduWDETV1\"}} {:nextjournal/value [:div.viewer-markdown [:p [:span \"Other data structures are presented with \"] [:code [:span \"[v/inspect ...]\"]] [:span \":\"]]], :nextjournal/viewer {:name :html-, :render-fn #viewer-fn identity, :hash \"5dsKyVZX2dPvsyoeg6dNrfeuqAh5UK\"}} {:nextjournal/value \"(show-cljs\\n {:key \\\"value\\\"})\", :nextjournal/opts {:loc {:line 62, :column 1}}, :nextjournal/viewer {:name :code, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5duGVW4Xoi1QoW73J5wMRghqm9uVoW\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"clerk-utils.show-1312995903\", :nextjournal/viewer {:render-fn #viewer-fn (fn render-var [fn-name] (applied-science.js-interop/update-in! js/window [:show-cljs fn-name] (fn [x] (or x (reagent.core/atom {:loading? true})))) (let [res (clojure.core/deref (j/get-in js/window [:show-cljs fn-name]))] (if (:loading? res) [:div.show-cljs-loading {:style {:color \"rgba(0,0,0,0.5)\"}} \"Loading...\"] (let [result (try ((:f res)) (catch js/Error e (js/console.error e) [nextjournal.clerk.render/error-view e]))] (if (and (vector? result) (not (:inspect (meta result)))) [:div.show-cljs-loaded result] [nextjournal.clerk.render/inspect result]))))), :hash \"5dsETUDCusAwKc7zXe7p2bq3JGeWBz\"}}}, :nextjournal/viewer {:name :clerk/result, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5drtBjvRGKwhUFrDTtWvTAduWDETV1\"}} {:nextjournal/value [:div.viewer-markdown [:p [:span \"To present a vector as code, tag it with \"] [:code [:span \"^:inspect\"]] [:span \" to set the \"] [:code [:span \":inspect\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"entry in the vector's metadata to \"] [:code [:span \"true\"]] [:span \":\"]]], :nextjournal/viewer {:name :html-, :render-fn #viewer-fn identity, :hash \"5dsKyVZX2dPvsyoeg6dNrfeuqAh5UK\"}} {:nextjournal/value \"(show-cljs\\n (let [text \\\"Include any Reagent vector!\\\"]\\n   ^:inspect\\n   [:pre text]))\", :nextjournal/opts {:loc {:line 68, :column 1}}, :nextjournal/viewer {:name :code, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5duGVW4Xoi1QoW73J5wMRghqm9uVoW\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"clerk-utils.show-1151529027\", :nextjournal/viewer {:render-fn #viewer-fn (fn render-var [fn-name] (applied-science.js-interop/update-in! js/window [:show-cljs fn-name] (fn [x] (or x (reagent.core/atom {:loading? true})))) (let [res (clojure.core/deref (j/get-in js/window [:show-cljs fn-name]))] (if (:loading? res) [:div.show-cljs-loading {:style {:color \"rgba(0,0,0,0.5)\"}} \"Loading...\"] (let [result (try ((:f res)) (catch js/Error e (js/console.error e) [nextjournal.clerk.render/error-view e]))] (if (and (vector? result) (not (:inspect (meta result)))) [:div.show-cljs-loaded result] [nextjournal.clerk.render/inspect result]))))), :hash \"5dsETUDCusAwKc7zXe7p2bq3JGeWBz\"}}}, :nextjournal/viewer {:name :clerk/result, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5drtBjvRGKwhUFrDTtWvTAduWDETV1\"}} {:nextjournal/value [:div.viewer-markdown [\"h2\" {:id \"automatic-reloading\"} [:span \"Automatic Reloading\"]] [:p [:span \"If you have a \"] [:code [:span \"shadow-cljs\"]] [:span \" watcher process running, any change to the code\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"within a \"] [:code [:span \"show-cljs\"]] [:span \" block is automatically recompiled and reloaded in the\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"Clerk notebook. You might see \"] [:code [:span \"loading...\"]] [:span \" appear if Clerk's load happens\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"before \"] [:code [:span \"shadow-cljs\"]] [:span \" finishes compilation.\"]] [\"h2\" {:id \"exporting-code-from-clojurescript\"} [:span \"Exporting code from ClojureScript\"]] [:p [:span \"As with \"] [:code [:span \"show-sci\"]] [:span \", multiple forms are allowed. All are evaluated and only\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"the final form is presented:\"]]], :nextjournal/viewer {:name :html-, :render-fn #viewer-fn identity, :hash \"5dsKyVZX2dPvsyoeg6dNrfeuqAh5UK\"}} {:nextjournal/value \"(show-cljs\\n (defn quizzical [s]\\n   (str s \\\"...?\\\"))\\n\\n [:pre (quizzical \\\"Hi\\\")])\", :nextjournal/opts {:loc {:line 85, :column 1}}, :nextjournal/viewer {:name :code, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5duGVW4Xoi1QoW73J5wMRghqm9uVoW\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"clerk-utils.show--1318448940\", :nextjournal/viewer {:render-fn #viewer-fn (fn render-var [fn-name] (applied-science.js-interop/update-in! js/window [:show-cljs fn-name] (fn [x] (or x (reagent.core/atom {:loading? true})))) (let [res (clojure.core/deref (j/get-in js/window [:show-cljs fn-name]))] (if (:loading? res) [:div.show-cljs-loading {:style {:color \"rgba(0,0,0,0.5)\"}} \"Loading...\"] (let [result (try ((:f res)) (catch js/Error e (js/console.error e) [nextjournal.clerk.render/error-view e]))] (if (and (vector? result) (not (:inspect (meta result)))) [:div.show-cljs-loaded result] [nextjournal.clerk.render/inspect result]))))), :hash \"5dsETUDCusAwKc7zXe7p2bq3JGeWBz\"}}}, :nextjournal/viewer {:name :clerk/result, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5drtBjvRGKwhUFrDTtWvTAduWDETV1\"}} {:nextjournal/value [:div.viewer-markdown [:p [:span \"Any \"] [:code [:span \"defn\"]] [:span \" you include will be available to forms below:\"]]], :nextjournal/viewer {:name :html-, :render-fn #viewer-fn identity, :hash \"5dsKyVZX2dPvsyoeg6dNrfeuqAh5UK\"}} {:nextjournal/value \"(show-cljs\\n [:pre (quizzical \\\"Still here\\\")])\", :nextjournal/opts {:loc {:line 93, :column 1}}, :nextjournal/viewer {:name :code, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5duGVW4Xoi1QoW73J5wMRghqm9uVoW\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"clerk-utils.show--454260131\", :nextjournal/viewer {:render-fn #viewer-fn (fn render-var [fn-name] (applied-science.js-interop/update-in! js/window [:show-cljs fn-name] (fn [x] (or x (reagent.core/atom {:loading? true})))) (let [res (clojure.core/deref (j/get-in js/window [:show-cljs fn-name]))] (if (:loading? res) [:div.show-cljs-loading {:style {:color \"rgba(0,0,0,0.5)\"}} \"Loading...\"] (let [result (try ((:f res)) (catch js/Error e (js/console.error e) [nextjournal.clerk.render/error-view e]))] (if (and (vector? result) (not (:inspect (meta result)))) [:div.show-cljs-loaded result] [nextjournal.clerk.render/inspect result]))))), :hash \"5dsETUDCusAwKc7zXe7p2bq3JGeWBz\"}}}, :nextjournal/viewer {:name :clerk/result, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5drtBjvRGKwhUFrDTtWvTAduWDETV1\"}} {:nextjournal/value [:div.viewer-markdown [:p [:span \"By default, these \"] [:code [:span \"defn\"]] [:span \"s will \"] [:em [:span \"not\"]] [:span \" be available to the SCI environment that\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"run Clerk's viewers:\"]]], :nextjournal/viewer {:name :html-, :render-fn #viewer-fn identity, :hash \"5dsKyVZX2dPvsyoeg6dNrfeuqAh5UK\"}} {:nextjournal/value \"(show-sci\\n [:pre (quizzical \\\"Still here\\\")])\", :nextjournal/opts {:loc {:line 99, :column 1}}, :nextjournal/viewer {:name :code, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5duGVW4Xoi1QoW73J5wMRghqm9uVoW\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value {}, :nextjournal/viewer {:render-fn #viewer-fn (clojure.core/fn [___30510__auto__] (clojure.core/let [result__30511__auto__ (do [:pre (quizzical \"Still here\")])] (v/html (if (clojure.core/vector? result__30511__auto__) result__30511__auto__ [nextjournal.clerk.render/inspect result__30511__auto__])))), :hash \"5dtFGZ7LUQoiMGZbdS86QLuDzux9T3\"}}}, :nextjournal/viewer {:name :clerk/result, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5drtBjvRGKwhUFrDTtWvTAduWDETV1\"}} {:nextjournal/value [:div.viewer-markdown [:p [:span \"To make a \"] [:code [:span \"defn\"]] [:span \" available to the SCI environment, use \"] [:code [:span \"^:export\"]] [:span \" metadata on\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"the \"] [:code [:span \"defn\"]] [:span \". You'll need to reload the page; live reload does not work in this\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"case.\"]] [:blockquote [:p [:span \"Note that this only works with a top-level \"] [:code [:span \"defn\"]] [:span \" inside of \"] [:code [:span \"show-cljs\"]] [:span \"! It\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"will fail if the \"] [:code [:span \"defn\"]] [:span \" lives inside of a \"] [:code [:span \"let\"]] [:span \" binding, \"] [:code [:span \"do\"]] [:span \", or anything\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"similar.\"]]]], :nextjournal/viewer {:name :html-, :render-fn #viewer-fn identity, :hash \"5dsKyVZX2dPvsyoeg6dNrfeuqAh5UK\"}} {:nextjournal/value \"(show-cljs\\n (defn ^:export winking [s]\\n   (str s \\\" ;)\\\")))\", :nextjournal/opts {:loc {:line 110, :column 1}}, :nextjournal/viewer {:name :code, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5duGVW4Xoi1QoW73J5wMRghqm9uVoW\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value nil, :nextjournal/viewer {:render-fn #viewer-fn (fn [_] [:span.cmt-default.inspected-value \"nil\"]), :hash \"5dt56BVQ65JwEuiaP54YohiwTPegMW\"}}}, :nextjournal/viewer {:name :clerk/result, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5drtBjvRGKwhUFrDTtWvTAduWDETV1\"}} {:nextjournal/value [:div.viewer-markdown [:p [:span \"On the SCI side, you'll need to call the function via JavaScript. Note\"]] [:ul [:li [:<> [:span \"the \"] [:code [:span \"js/\"]] [:span \" prefix\"]]] [:li [:<> [:span \"any dashes in the namespace have to be converted to underscores\"]]] [:li [:<> [:span \"no slash between namespace and function name\"]]]]], :nextjournal/viewer {:name :html-, :render-fn #viewer-fn identity, :hash \"5dsKyVZX2dPvsyoeg6dNrfeuqAh5UK\"}} {:nextjournal/value \"(show-sci\\n [:pre (js/clerk_utils.show.winking \\\"Yo\\\")])\", :nextjournal/opts {:loc {:line 120, :column 1}}, :nextjournal/viewer {:name :code, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5duGVW4Xoi1QoW73J5wMRghqm9uVoW\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value {}, :nextjournal/viewer {:render-fn #viewer-fn (clojure.core/fn [___30510__auto__] (clojure.core/let [result__30511__auto__ (do [:pre (js/clerk_utils.show.winking \"Yo\")])] (v/html (if (clojure.core/vector? result__30511__auto__) result__30511__auto__ [nextjournal.clerk.render/inspect result__30511__auto__])))), :hash \"5drP8wdPE5KHnmMcnpCc2c6JYN1CNN\"}}}, :nextjournal/viewer {:name :clerk/result, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5drtBjvRGKwhUFrDTtWvTAduWDETV1\"}} {:nextjournal/value [:div.viewer-markdown [\"h2\" {:id \"project-setup\"} [:span \"Project Setup\"]] [:p [:span \"To compile cljc files and render them in Clerk you'll need to configure your\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"project to watch and build your cljc files and make them available to Clerk.\"]] [:p [:span \"This section will cover each of the following steps:\"]] [:ul [:li [:<> [:span \"Configure \"] [:code [:span \"deps.edn\"]] [:span \" with the required entries for a custom Clerk\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"ClojureScript build\"]]] [:li [:<> [:span \"Set up \"] [:a {:href \"https://shadow-cljs.github.io/docs/UsersGuide.html\"} [:code [:span \"shadow-cljs.edn\"]]]]] [:li [:<> [:span \"Configure \"] [:code [:span \"package.json\"]]]] [:li [:<> [:span \"Configure \"] [:code [:span \"user.clj\"]]]] [:li [:<> [:span \"Coordinate tasks with \"] [:a {:href \"https://github.com/babashka/babashka\"} [:span \"Babashka\"]] [:span \" via\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:code [:span \"bb.edn\"]]]] [:li [:<> [:span \"Ship a static build via Github Pages or \"] [:a {:href \"https://github.clerk.garden/\"} [:span \"Clerk's\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"Garden\"]] [:span \" static publishing system.\"]]]] [\"h3\" {:id \"deps.edn\"} [:span \"deps.edn\"]] [:p [:span \"To build custom ClojureScript you'll need to depend\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"on \"] [:a {:href \"https://shadow-cljs.github.io/docs/UsersGuide.html\"} [:code [:span \"shadow-cljs\"]]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"and \"] [:a {:href \"https://github.com/nextjournal/clerk/tree/main/render\"} [:code [:span \"clerk-render\"]]] [:span \".\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"I like to add \"] [:code [:span \"shadow-cljs\"]] [:span \" under a \"] [:code [:span \":dev\"]] [:span \" alias, and \"] [:code [:span \"clerk-render\"]] [:span \" under a\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"new \"] [:code [:span \":nextjournal/clerk\"]] [:span \" alias.\"]] [:p [:span \"Here is an annotated example \"] [:code [:span \":aliases\"]] [:span \" entry in \"] [:code [:span \"deps.edn\"]] [:span \":\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:div.viewer-code [#viewer-eval nextjournal.clerk.render/inspect-presented {:path (0), :nextjournal/value \"{:aliases\\n {:dev\\n  {:extra-deps\\n   {org.clojure/clojure {:mvn/version \\\"1.11.1\\\"}\\n\\n    ;; This version needs to match the shadow-cljs version declared in\\n    ;; `package.json`.\\n    thheller/shadow-cljs {:mvn/version \\\"2.20.14\\\"}\\n\\n    ;; the clojurescript version must match (or exceed?) the version declared by\\n    ;; shadow-cljs:\\n    ;; https://github.com/thheller/shadow-cljs/blob/master/project.clj#L40\\n    org.clojure/clojurescript {:mvn/version \\\"1.11.60\\\"}}}\\n\\n  :nextjournal/clerk\\n  {;; I include :extra-paths here because my documentation notebooks live in\\n   ;; `\\\"dev\\\"` and I don't want to deploy them with the library. This isn't\\n   ;; necessary if your notebooks live alongside your source code.\\n   :extra-paths [\\\"dev\\\"]\\n   :extra-deps\\n   ;; You'll need a dependency on clerk and clerk.render. The latter lives\\n   ;; inside of the Clerk repository, so the versions here need to match.\\n   ;;\\n   ;; I recommend using git dependencies here. Use the same `:git/sha` for each\\n   ;; dependency and bump them together.\\n   {io.github.nextjournal/clerk\\n    {:git/sha \\\"ec666210f11763fce4fec74072acca1e6525d29f\\\"}\\n    io.github.nextjournal/clerk.render\\n    {:git/url \\\"https://github.com/nextjournal/clerk\\\"\\n     :git/sha \\\"ec666210f11763fce4fec74072acca1e6525d29f\\\"\\n     :deps/root \\\"render\\\"}}\\n\\n   ;; Note that this points to a function in your `user.clj`, explained below.\\n   :exec-fn user/garden!}}}\\n\", :nextjournal/viewer {:name :code, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5duGVW4Xoi1QoW73J5wMRghqm9uVoW\"}}]], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [\"h3\" {:id \"shadow-cljs\"} [:span \"shadow-cljs\"]] [:p [:span \"Next, create a file called \"] [:code [:span \"shadow-cljs.edn\"]] [:span \" in the root of your project.\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"This file configured\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"the \"] [:a {:href \"https://shadow-cljs.github.io/docs/UsersGuide.html\"} [:code [:span \"shadow-cljs\"]]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"ClojureScript build tool to generate the JavaScript bundle that Clerk needs\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"to run in development and static-build modes.\"]] [:p [:span \"Install \"] [:code [:span \"shadow-cljs\"]] [:span \" via NPM (\"] [:a {:href \"https://shadow-cljs.github.io/docs/UsersGuide.html#_standalone_via_code_npm_code\"} [:span \"guide\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"here\"]] [:span \").\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"If you've installed \"] [:code [:span \"shadow-cljs\"]] [:span \" globally by running \"] [:code [:span \"npm install -g  shadow-cljs\"]] [:span \", run the following command to start a process that builds the JS\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"and rebuilds it on any source code change:\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:div.viewer-code [#viewer-eval nextjournal.clerk.render/inspect-presented {:path (0), :nextjournal/value \"shadow-cljs watch clerk\\n\", :nextjournal/viewer {:name :code, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5duGVW4Xoi1QoW73J5wMRghqm9uVoW\"}}]], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:p [:span \"Build your final production bundle with\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:div.viewer-code [#viewer-eval nextjournal.clerk.render/inspect-presented {:path (0), :nextjournal/value \"shadow-cljs watch clerk\\n\", :nextjournal/viewer {:name :code, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5duGVW4Xoi1QoW73J5wMRghqm9uVoW\"}}]], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:p [:span \"Here's an annotated example \"] [:code [:span \"shadow-cljs.edn\"]] [:span \" file:\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:div.viewer-code [#viewer-eval nextjournal.clerk.render/inspect-presented {:path (0), :nextjournal/value \" {;; This first entry tells shadow-cljs to pull its dependencies from `deps.edn`,\\n  ;; and to merge in the specified aliases when doing so.\\n  :deps\\n  {:aliases [:dev :nextjournal/clerk]}\\n  ;; I set this port so that the server started by shadow-cljs in this project\\n  ;; doesn't clash with other projects I may have running. You'll need the port\\n  ;; in `user.clj` later.\\n  :dev-http {8765 \\\"public\\\"}\\n  :builds\\n\\n  ;; This `:clerk` keyword explains the `clerk` in `shadow-cljs watch clerk` above.\\n  {:clerk\\n   {:target :esm\\n    :runtime :browser\\n    :output-dir \\\"public/js\\\"\\n    :compiler-options\\n    {:infer-externs :auto\\n     :optimizations :advanced}\\n    :modules\\n    ;; Note the keyword `:main`. Your final JS bundle will live at\\n    ;; `<output-dir>/main.js`. Change this keyword or the `:output-dir` above to\\n    ;; tune this.\\n    {:main\\n     {:entries\\n      ;; shadow-cljs will include these namespaces and any namespaces they depend\\n      ;; on in your final bundle. The `static-app` entry is required.\\n      ;;\\n      ;; You'll need to list your `cljc` namespaces here as well for `show-cljs`\\n      ;; to work. You could also add a single namespace like\\n      ;; `my-project.extensions` and a corresponding\\n      ;; `dev/my_project/extensions.cljs`, and `require` all of your `cljc` and\\n      ;; `cljs` files inside that namespace.\\n      [nextjournal.clerk.static-app\\n       clerk-utils.show]}}\\n    :js-options\\n    {:output-feature-set :es8}}}}\\n\", :nextjournal/viewer {:name :code, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5duGVW4Xoi1QoW73J5wMRghqm9uVoW\"}}]], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [\"h3\" {:id \"package.json\"} [:span \"package.json\"]] [:p [:code [:span \"shadow-cljs\"]] [:span \" defers to \"] [:code [:span \"deps.edn\"]] [:span \" for any ClojureScript dependencies, and a\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"file called \"] [:code [:span \"package.json\"]] [:span \" for any straight JavaScript dependencies. Create\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:code [:span \"package.json\"]] [:span \" in your project's root, modeled after the template below.\"]] [:p [:span \"I also like to use \"] [:code [:span \"package.json\"]] [:span \" for its \\\"scripts\\\" feature; this lets me\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"call \"] [:code [:span \"shadow-cljs\"]] [:span \" as a local library instead of a globally installed\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"library, which helps make sure that its version matches the version declared\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"in \"] [:code [:span \"deps.edn\"]] [:span \".\"]] [:p [:code [:span \"shadow-cljs\"]] [:span \" will automatically add any JavaScript dependencies declared by\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"its ClojureScript to \"] [:code [:span \"package.json\"]] [:span \", and install them into the project. The\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"first time you build your JavaScript, \"] [:code [:span \"package.json\"]] [:span \" will get a bunch of new\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"entries. Commit these changes to version control.\"]] [:p [:span \"If \"] [:em [:span \"your\"]] [:span \" library has JavaScript dependencies that you want consumers to\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"install, declare these in \"] [:code [:span \"src/deps.cljs\"]] [:span \" (like \"] [:a {:href \"https://github.com/mentat-collective/jsxgraph.cljs/blob/main/src/deps.cljs\"} [:code [:span \"jsxgraph.cljs\"]] [:span \" does\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"here\"]] [:span \",\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"for example).\"]] [:p [:span \"The following annotated \"] [:code [:span \"package.json\"]] [:span \" includes \"] [:code [:span \"shadow-cljs\"]] [:span \" and a few\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"scripts I've found helpful. Delete them, or call them with \"] [:code [:span \"npm run  <script-name>\"]] [:span \".\"]] [:blockquote [:p [:span \"Comments are not allowed in JSON, so DELETE THE COMMENTS after copying this\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"code to your \"] [:code [:span \"package.json\"]] [:span \"!\"]]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:div.viewer-code [#viewer-eval nextjournal.clerk.render/inspect-presented {:path (0), :nextjournal/value \"{\\n  \\\"devDependencies\\\": {\\n    \\\"shadow-cljs\\\": \\\"^2.20.14\\\",\\n\\n    // This dep and the `gh-pages` script below allows you to ship a static\\n    // build to Github Pages.\\n    \\\"gh-pages\\\": \\\"^3.2.3\\\",\\n\\n    // This is helpful for viewing a static build locally.\\n    \\\"http-server\\\": \\\"^14.1.1\\\"\\n  },\\n  \\\"scripts\\\": {\\n    // Run the build-with-file-watcher process from the version of shadow-cljs\\n    // declared above.\\n    \\\"watch-clerk\\\": \\\"shadow-cljs watch clerk\\\",\\n\\n    // -o opens the browser, and -c-1 disables caching. This is important,\\n    // because the JS filename doesn't change when shadow-cljs rebuilds it!\\n    \\\"serve\\\": \\\"http-server -c-1 -o\\\",\\n\\n    // deploys the static build to Github Pages.\\n    \\\"gh-pages\\\": \\\"gh-pages -d public --dotfiles true\\\",\\n\\n    // Generates a production version of this project's JavaScript bundle.\\n    \\\"release-clerk\\\": \\\"shadow-cljs release clerk\\\"\\n  }\\n}\\n\", :nextjournal/viewer {:name :code, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5duGVW4Xoi1QoW73J5wMRghqm9uVoW\"}}]], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [\"h3\" {:id \"user.clj\"} [:span \"user.clj\"]] [:p [:span \"To run Clerk with a custom ClojureScript bundle you'll need to modify its\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"internal config on startup. I prefer to do this via a suite of functions in\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:code [:span \"dev/user.clj\"]] [:span \". The \"] [:code [:span \"user\"]] [:span \" namespace is automatically loaded by Clojure, so\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"these functions will be available at a fresh REPL.\"]] [:p [:span \"Here is a template for a \"] [:code [:span \"user.clj\"]] [:span \" file that can handle starting Clerk in\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"interactive mode, or building a static Clerk bundle to serve in Github Pages\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"or Clerk's Garden:\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:div.viewer-code [#viewer-eval nextjournal.clerk.render/inspect-presented {:path (0), :nextjournal/value \"(ns user\\n  \\\"This namespace template assumes that your project lives at\\n  https://github.com/$YOUR_ORG/$PROJECT_NAME. Replace all occurrences of\\n  $YOUR_ORG and $PROJECT_NAME below accordingly.\\\"\\n  (:require [babashka.fs :as fs]\\n            [clojure.java.shell :refer [sh]]\\n            [clojure.string]\\n            [nextjournal.clerk :as clerk]\\n            [nextjournal.clerk.config :as config]\\n            [nextjournal.clerk.view]\\n            [nextjournal.clerk.viewer :as cv]\\n            [shadow.cljs.devtools.api :as shadow]))\\n\\n(def index\\n  ;; Replace this with the namespace you'd like to use as your index.\\n  \\\"dev/clerk_utils/notebook.clj\\\")\\n\\n(def build-target\\n  ;; This is the argument to `clerk/build!`.\\n  {:index index\\n   :git/url \\\"https://github.com/$YOUR_ORG/$PROJECT_NAME\\\"\\n   :paths [\\\"dev/clerk_utils/show.cljc\\\"]})\\n\\n(def ^{:doc \\\"static site defaults for local and github-pages modes.\\\"}\\n  defaults\\n  {;; This matches the path in `shadow-cljs.edn`.\\n   :out-path   \\\"public\\\"\\n   ;; Depending on where you are serving Github Pages from, you might need to\\n   ;; modify this. This setting is good if you are using a custom top level\\n   ;; domain. If you are serving from `$YOUR_ORG.github.io/$PROJECT_NAME`, then\\n   ;; change this string to `/$PROJECT_NAME/` with the trailing backslash.\\n   :cas-prefix \\\"/\\\"})\\n\\n(def ^{:doc \\\"static site defaults for Clerk's Garden CDN.\\\"}\\n  garden-defaults\\n  {:cas-prefix \\\"/$YOUR_ORG/$PROJECT_NAME/commit/$GIT_SHA/\\\"})\\n\\n(defn start!\\n  \\\"Runs [[clerk/serve!]] with our custom JS. Run this after generating custom JS\\n  with shadow in either production or `watch` mode.\\n\\n  Note that this port must match the port declared in `shadow-cljs.edn`.\\\"\\n  []\\n  (swap! config/!resource->url\\n         assoc\\n         \\\"/js/viewer.js\\\" \\\"http://localhost:8765/js/main.js\\\")\\n  (clerk/serve!\\n   {:browse? true\\n    :watch-paths [\\\"dev\\\"]})\\n  (Thread/sleep 500)\\n  (clerk/show! index))\\n\\n(defn git-sha\\n  \\\"Returns the sha hash of this project's current git revision.\\\"\\n  []\\n  (-> (sh \\\"git\\\" \\\"rev-parse\\\" \\\"HEAD\\\")\\n      (:out)\\n      (clojure.string/trim)))\\n\\n(defn static-build!\\n  \\\"This task is used to generate static sites for local use, github pages\\n  deployment and Clerk's Garden CDN.\\n\\n  Accepts a map of options `opts` and runs the following tasks:\\n\\n  - Slurps the output of the shadow-cljs `:clerk` build from `public/js/main.js`\\n    and pushes it into a CAS located at `(str (:out-path opts) \\\\\\\"/js/_data\\\\\\\")`.\\n\\n  - Configures Clerk to generate files that load the js from the generated name\\n    above, stored in `(str (:cas-prefix opts) \\\\\\\"/js/_data\\\\\\\")`\\n\\n  - Creates a static build of the single namespace [[index]] at `(str (:out-path\\n    opts) \\\\\\\"/index.html\\\\\\\")`\\n\\n  All `opts` are forwarded to [[nextjournal.clerk/build!]].\\\"\\n  [opts]\\n  (let [{:keys [out-path cas-prefix]} (merge defaults opts)\\n        sha (or (:git/sha opts) (git-sha))\\n        cas (cv/store+get-cas-url!\\n             {:out-path (str out-path \\\"/js\\\") :ext \\\"js\\\"}\\n             (fs/read-all-bytes \\\"public/js/main.js\\\"))]\\n    (swap! config/!resource->url assoc\\n           \\\"/js/viewer.js\\\"\\n           (str cas-prefix \\\"js/\\\" cas))\\n    (clerk/build!\\n     (merge build-target\\n            (assoc opts :out-path out-path\\n                        :git/sha sha)))))\\n\\n(defn garden!\\n  \\\"Standalone executable function that runs [[static-build!]] configured for\\n  Clerk's Garden. See [[garden-defaults]] for customizations\\n  to [[static-build!]].\\\"\\n  [opts]\\n  (println \\\"Running npm install...\\\")\\n  (println\\n   (sh \\\"npm\\\" \\\"install\\\"))\\n  (shadow/release! :clerk)\\n  (static-build!\\n   (merge garden-defaults opts)))\\n\", :nextjournal/viewer {:name :code, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5duGVW4Xoi1QoW73J5wMRghqm9uVoW\"}}]], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [\"h3\" {:id \"bb.edn\"} [:span \"bb.edn\"]] [:p [:span \"The \"] [:a {:href \"https://github.com/babashka/babashka\"} [:span \"Babashka\"]] [:span \" task runner does a great\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"job of coordinating calls to all of the build tools at play above.\"]] [:p [:span \"Add a file called \"] [:code [:span \"bb.edn\"]] [:span \" to your project's root with the following\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"contents. After installing Babashka, call each task with \"] [:code [:span \"bb <task-name>\"]] [:span \".\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:code [:span \"bb tasks\"]] [:span \" will generate a list of all tasks with their docstrings.\"]] [:p [:span \"Read through the tasks and customize the template for your project. (This\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"template also includes a \"] [:code [:span \"bb lint\"]] [:span \" task!)\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:div.viewer-code [#viewer-eval nextjournal.clerk.render/inspect-presented {:path (0), :nextjournal/value \"{:pods {clj-kondo/clj-kondo {:version \\\"2022.12.10\\\"}}\\n :tasks\\n {:requires ([pod.borkdude.clj-kondo :as clj-kondo])\\n\\n  dev\\n  {:doc \\\"Start a shadow-cljs watch process that generates this project's custom JS.\\\"\\n   :task\\n   (do (shell \\\"npm install\\\")\\n       (shell \\\"npm run watch-clerk\\\"))}\\n\\n  start-clerk\\n  {:doc \\\"Start a Clerk dev server configured with this project's custom JS.\\\"\\n   :task\\n   (shell \\\"clojure -X:dev:nextjournal/clerk user/start!\\\")}\\n\\n  build-static\\n  {:doc \\\"Generate a fresh static build.\\\"\\n   :task\\n   (do (shell \\\"npm ci\\\")\\n       (shell \\\"npm run release-clerk\\\")\\n       (apply shell\\n              \\\"clojure -X:dev:nextjournal/clerk user/static-build!\\\"\\n              *command-line-args*)\\n       ;; If you want to serve your project from a custom domain hosted by\\n       ;; Github Pages, Remove the #_ and add your custom URL here.\\n       #_\\n       (spit \\\"./public/CNAME\\\" \\\"YOUR_PROJECT_URL\\\")\\n\\n       ;; This is necessary for folders with underscores to work, like the one\\n       ;; that Clerk uses to store data for its CAS.\\n       (spit \\\"./public/.nojekyll\\\" \\\"\\\"))}\\n\\n  release-gh-pages\\n  {:doc \\\"Generate a fresh static build and release it to Github Pages.\\\"\\n   :task\\n   (do (shell \\\"rm -rf public\\\")\\n       (run 'build-static)\\n       (shell \\\"npm run gh-pages\\\"))}\\n\\n  publish-local\\n  {:doc \\\"Generate a fresh static build in the `public` folder and start a local\\n  webserver.\\\"\\n   :task\\n   (do (run 'build-static)\\n       (shell \\\"npm run serve\\\"))}\\n\\n  lint\\n  {:doc \\\"Lint the src and dev directories with clj-kondo.\\\"\\n   :task (clj-kondo/print!\\n          (clj-kondo/run! {:lint [\\\"src\\\" \\\"dev\\\"]}))}}}\\n\", :nextjournal/viewer {:name :code, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5duGVW4Xoi1QoW73J5wMRghqm9uVoW\"}}]], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:p [:span \"Github Pages Action\"]] [:p [:span \"If you are hosting your project on Github, add the following template to\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:code [:span \".github/workflows/gh-pages.yml\"]] [:span \" to have Github automatically build and\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"deploy your Clerk static build on every push to \"] [:code [:span \"main\"]] [:span \".\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:div.viewer-code [#viewer-eval nextjournal.clerk.render/inspect-presented {:path (0), :nextjournal/value \"name: GitHub Pages\\n\\non:\\n  push:\\n    branches:\\n      - main  # Set a branch name to trigger deployment\\njobs:\\n  publish:\\n    runs-on: ubuntu-20.04\\n    steps:\\n      - name: Cache Maven packages\\n        uses: actions/cache@v3\\n        with:\\n          path: ~/.m2\\n          key: ${{ runner.os }}-m2-${{ hashFiles('**/deps.edn') }}\\n          restore-keys: ${{ runner.os }}-m2\\n\\n      - uses: actions/checkout@v3\\n\\n      - name: Install clojure tools\\n        uses: DeLaGuardo/setup-clojure@4.0\\n        with:\\n          cli: 1.11.1.1208 # Clojure CLI based on tools.deps\\n          github-token: ${{ secrets.GITHUB_TOKEN }}\\n\\n      - name: Install babashka\\n        uses: just-sultanov/setup-babashka@v2\\n        with:\\n          version: '0.8.156'\\n\\n      - name: Build static site\\n        run: bb build-static\\n\\n      - name: Deploy\\n        uses: peaceiris/actions-gh-pages@v3\\n        if: ${{ github.ref == 'refs/heads/main' }}\\n        with:\\n          github_token: ${{ secrets.GITHUB_TOKEN }}\\n          publish_dir: ./public\\n\", :nextjournal/viewer {:name :code, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5duGVW4Xoi1QoW73J5wMRghqm9uVoW\"}}]], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [\"h3\" {:id \"clerk's-garden\"} [:span \"Clerk's Garden\"]] [:p [:span \"To build and host your project with Garden, simply visit\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:code [:span \"https://github.clerk.garden/$YOUR_ORG/$PROJECT_NAME\"]] [:span \", and watch the build\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"process commence.\"]] [:blockquote [:p [:span \"You'll need to have configured your project using the templates above for\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"this to work with custom ClojureScript.\"]]] [\"h2\" {:id \"thanks-and-support\"} [:span \"Thanks and Support\"]] [:p [:span \"To support this work and my other open source projects, consider sponsoring\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"me via my \"] [:a {:href \"https://github.com/sponsors/sritchie\"} [:span \"GitHub Sponsors page\"]] [:span \". Thank\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"you to my current sponsors!\"]] [:p [:span \"I'm grateful to \"] [:a {:href \"https://www.clojuriststogether.org/\"} [:span \"Clojurists Together\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"for financial support during this library's creation. Please\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"consider \"] [:a {:href \"https://www.clojuriststogether.org/developers/\"} [:span \"becoming a member\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"to support this work and projects like it.\"]] [:p [:span \"For more information on me and my work, visit \"] [:a {:href \"https://samritchie.io\"} [:span \"https://samritchie.io\"]] [:span \".\"]] [\"h2\" {:id \"license\"} [:span \"License\"]] [:p [:span \"Copyright © 2022 Sam Ritchie.\"]] [:p [:span \"Distributed under the \"] [:a {:href \"https://github.com/mentat-collective/clerk-utils/blob/main/LICENSE\"} [:span \"MIT\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"License\"]] [:span \".\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:span \" \"], :nextjournal/viewer {:name :html, :render-fn #viewer-fn identity, :hash \"5dqwbRQVFnHkdooT8QV8nfPHBGVWtj\"}}] [:span \"See \"] [:a {:href \"https://github.com/mentat-collective/clerk-utils/blob/main/LICENSE\"} [:span \"LICENSE\"]] [:span \".\"]]], :nextjournal/viewer {:name :html-, :render-fn #viewer-fn identity, :hash \"5dsKyVZX2dPvsyoeg6dNrfeuqAh5UK\"}}], :css-class nil}, :nextjournal/viewer {:name :clerk/notebook, :render-fn #viewer-fn nextjournal.clerk.render/render-notebook, :hash \"5dt1qwFEn2BQwdEM84VqwY4LR6p4YV\"}}}, :index \"dev/clerk_utils/notebook.clj\", :browse? false, :git/url \"https://github.com/mentat-collective/clerk-utils\", :paths [\"dev/clerk_utils/show.cljc\" \"dev/clerk_utils/notebook.clj\"], :resource->url {\"/js/viewer.js\" \"/js/_data/8Vu7sBmZoJDRPJJyQfKL1ufTz3faQLkyRj9oHVVb8f7LBgCtVN7YYbTSbJWTKJ374W2xs75vFRHpEhLrpFdfTxAmWU.js\"}, :current-path \"dev/clerk_utils/show.cljc\", :bundle? false, :git/sha \"66039ac8b890329a8d5d84aeb9ecf7387b98f945\", :path->url {\"dev/clerk_utils/show.cljc\" \"dev/clerk_utils/show.html\", \"dev/clerk_utils/notebook.clj\" \"\"}, :expanded-paths [\"dev/clerk_utils/show.cljc\" \"dev/clerk_utils/notebook.clj\"], :report-fn #object[nextjournal.clerk.builder$stdout_reporter 0x10b5e705 \"nextjournal.clerk.builder$stdout_reporter@10b5e705\"]}")
app.init(opts)
</script></body></html>